<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7 no-js" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8 no-js" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en" class="no-js">


<head>
    <title>
        {{{block "title"}}}
    </title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <link rel="profile" href="#">

    <!--Google Font-->
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Dosis:400,700,500|Nunito:300,400,600' />
    <!-- Mobile specific meta -->
    <meta name=viewport content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone-no">

    <!-- CSS files -->
    <link rel="stylesheet" href="/css/plugins.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/fontawesome/all.min.css" />
    <style>
        .search {
            position: relative;
            width: 500px;
        }

        .search-input {
            width: 100%;
            display: flex;
        }

        .search-input input[type=text] {
            border: none;
            border-bottom: 1px solid;
            background: transparent;
            color: #fff;
        }

        .search-result {
            position: absolute;
            top: 10;
            left: 0;
            right: 0;
            z-index: 1000; 
            display: flex;
        }

        .search-image {
            max-width: 100px;
        }

        .search-content {
            margin-left: 10px;
            margin-top: 10px;
            border-bottom: 1px solid;
        }

        .search-content h3 {
            color: #fff;
        }

        .search-content P:last-child {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            word-wrap: break-word;
            width: 250px;
        }

        .search-result .search-content, .search-result .search-image {
            flex: 1 1 auto;   
            margin-top: 10px;
        }
    </style>

    {{{block "style"}}}
</head>

<body>
    <div class="login-wrapper" id="forgot-password-content" x-data="{ email: '' }">
        <div class="login-content">
            <a href="#" class="close">x</a>
            <h3>Quên Mật Khẩu</h3>
            <form method="post">
                <div class="row">
                    <label for="username">
                        Email:
                        <input x-model="email" type="text" name="email" id="username"
                            pattern="^[^\s@]+@[^\s@]+$" required="required" />
                    </label>
                </div>
                <div class="row">
                    <button x-on:click="forgotPassword($event, email)">Gửi đi</button>
                </div>
            </form>
        </div>
    </div>
    <div class="login-wrapper" id="login-content" x-data="{ userName: '', password: ''}">
        <div class="login-content">
            <a href="#" class="close">x</a>
            <h3>Đăng Nhập</h3>
            <form method="post">
                <div class="row">
                    <label for="username">
                        Tài khoản:
                        <input x-model="userName" type="text" name="username" id="username"
                            pattern="^[a-zA-Z][a-zA-Z0-9-_\.]{8,20}$" required="required" />
                    </label>
                </div>

                <div class="row">
                    <label for="password">
                        Mật khẩu:
                        <input x-model="password" type="password" name="password" id="password"
                            pattern="(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$"
                            required="required" />
                    </label>
                </div>
                <div class="row">
                    <div class="remember">
                        <div>
                            <input type="checkbox" name="remember" value="Remember me"><span>Lưu thông tin</span>
                        </div>
                        <a href="#" class="forgotPasswordLink">Quên mật khẩu ?</a>
                    </div>
                </div>
                <div class="row">
                    <button  x-on:click="loginHandler($event, { userName, password })">Đăng nhập</button>
                </div>
            </form>
            <div class="row">
                <p>Mạng xã hội</p>
                <div class="social-btn-2">
                    <a class="fb" href="#"><i class="ion-social-facebook"></i>Facebook</a>
                    <a class="tw" href="#"><i class="ion-social-twitter"></i>Twitter</a>
                </div>
            </div>
        </div>
    </div>

    <div class="login-wrapper" id="signup-content" x-data="{ user_name: '', email: '', password: '', confPassword: '' }">
        <div class="login-content">
            <a href="#" class="close">x</a>
            <h3>Đăng Ký</h3>
            <form method="post" action="#">
                  <div class="row">
                    <label for="username-2">
                        Họ và tên:
                        <input x-model="name" type="text" name="name" id="full-name"
                            required="required" />
                    </label>
                </div>

                <div class="row">
                    <label for="username-2">
                        Tài khoản:
                        <input x-model="user_name" type="text" name="username" id="username-2"
                            pattern="^[a-zA-Z][a-zA-Z0-9-_\.]{8,20}$" required="required" />
                    </label>
                </div>

                <div class="row">
                    <label for="email-2">
                        Email:
                        <input x-model="email" type="text" name="email" id="email-2"
                            pattern="^[^\s@]+@[^\s@]+$"
                            required="required" />
                    </label>
                </div>
                <div class="row">
                    <label for="password-2">
                        Mật khẩu:
                        <input x-model="password" type="password" name="password" id="password-registrantion"
                            pattern="(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$"
                            required="required" />
                    </label>
                </div>
                <div class="row">
                    <label for="repassword-2">
                        Xác minh mật khẩu:
                        <input x-model="confPassword" type="password" name="password" id="repassword-registration"
                            pattern="(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$"
                            required="required" />
                    </label>
                </div>
                <div class="row">
                    <button type="submit" @click="registration($event, { user_name, email, password, name}, confPassword)">Đăng ký</button>
                </div>
            </form>
        </div>
    </div>

    <header class="ht-header">
        <div class="container">
            <nav class="navbar navbar-default navbar-custom">
                <div class="navbar-header logo">
                    <div class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <div id="nav-icon1">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                    <a href="index-2.html"><img class="logo" src="/images/logo1.png" alt="" width="119" height="58"></a>
                </div>
                <div class="collapse navbar-collapse flex-parent" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav flex-child-menu menu-left">
                        <li class="hidden">
                            <a href="#page-top"></a>
                        </li>
                        <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown">
                                Thể loại <i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1" style="color: #fff">
                                {{#each categories}}
                                    <li>
                                        <a href="/movie-list/{{ id }}">{{name}}</a>
                                    </li>
                                {{/each  }}
                            </ul>
                        </li>
                        <li class="search" x-data="initSearch()">
                            <div class="search-input">
                                <input type="text" x-on:input.debound.500="fetchMovies($event.target.value)"/>
                                <i class="icon-search"></i>
                            </div>
                            <div class="search-result" x-show="movies.length">
                                <template x-for="movie in movies">
                                     <div class="search-image">
                                        <img x-bind:src="poster" />
                                    </div>
                                    <div class="search-content">
                                        <h4 x-text="title"></h4>
                                        <p><i class="ion-android-star"></i><span x-text="movie_rate"></span> /10</p>
                                        {{!-- <p>Deleniti tempora eos doloremque in pariatur debitis blanditiis delectus cumque. Repellendus dolorum fugiat rerum accusantium magnam pariatur consequatur ad mollitia. Beatae commodi nam. Omnis cumque vitae pariatur maiores incidunt laudantium consectetur voluptatibus fuga. Officia consequatur quia necessitatibus maxime aperiam non sit vel.</p> --}}
                                    </div>
                                </template>
                            </div>
                        </li>
                        {{!-- <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown">
                                Home <i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1">
                                <li><a href="index-2.html">Home 01</a></li>
                                <li><a href="homev2.html">Home 02</a></li>
                                <li><a href="homev3.html">Home 03</a></li>
                            </ul>
                        </li>
                        <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown" data-hover="dropdown">
                                movies<i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1">
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Movie grid<i
                                            class="ion-ios-arrow-forward"></i></a>
                                    <ul class="dropdown-menu level2">
                                        <li><a href="moviegrid.html">Movie grid</a></li>
                                        <li><a href="moviegridfw.html">movie grid full width</a></li>
                                    </ul>
                                </li>
                                <li><a href="movielist.html">Movie list</a></li>
                                <li><a href="moviesingle.html">Movie single</a></li>
                                <li class="it-last"><a href="seriessingle.html">Series single</a></li>
                            </ul>
                        </li>
                        <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown" data-hover="dropdown">
                                celebrities <i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1">
                                <li><a href="celebritygrid01.html">celebrity grid 01</a></li>
                                <li><a href="celebritygrid02.html">celebrity grid 02 </a></li>
                                <li><a href="celebritylist.html">celebrity list</a></li>
                                <li class="it-last"><a href="celebritysingle.html">celebrity single</a></li>
                            </ul>
                        </li>
                        <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown" data-hover="dropdown">
                                news <i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1">
                                <li><a href="bloglist.html">blog List</a></li>
                                <li><a href="bloggrid.html">blog Grid</a></li>
                                <li class="it-last"><a href="blogdetail.html">blog Detail</a></li>
                            </ul>
                        </li>
                        <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown" data-hover="dropdown">
                                community <i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1">
                                <li><a href="userfavoritegrid.html">user favorite grid</a></li>
                                <li><a href="userfavoritelist.html">user favorite list</a></li>
                                <li><a href="userprofile.html">user profile</a></li>
                                <li class="it-last"><a href="userrate.html">user rate</a></li>
                            </ul>
                        </li> --}}
                    </ul>
                    <ul class="nav navbar-nav flex-child-menu menu-right">
                        {{!-- <li class="dropdown first">
                            <a class="btn btn-default dropdown-toggle lv1" data-toggle="dropdown" data-hover="dropdown">
                                pages <i class="fa fa-angle-down" aria-hidden="true"></i>
                            </a>
                            <ul class="dropdown-menu level1">
                                <li><a href="landing.html">Landing</a></li>
                                <li><a href="404.html">404 Page</a></li>
                                <li class="it-last"><a href="comingsoon.html">Coming soon</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Help</a></li> --}}
                        {{#if user}}
                            <li class="dropdown">
                                <a href="#" class="user_icon btn btn-default dropdown-toggle lv1" data-toggle="dropdown"><i class="fas fa-user"></i></a>
                                <ul class="dropdown-menu level1">
                                    <li><a href="/dashboard">Thông tin cá nhân</a></li>
                                    <li><a href="/authen/logout">Đăng xuất</a></li>
                                </ul>
                            </li>
                        {{else}}
                            <li class="loginLink"><a href="#">Đăng nhập</a></li>
                            <li class="btn signupLink"><a href="#">Đăng ký</a></li>
                        {{/if}}
                    </ul>
                </div>
                <!-- /.navbar-collapse -->
            </nav>

            {{!-- <div>
                <div class="top-search" x-data="initSearch()">
                    <select>
                        <option value="united">TV show</option>
                        <option value="saab">Others</option>
                    </select>
                    <input type="text" x-on:input.debound.500="fetchMovies($event.target.value)"/>
                    <template>

                    </template>
                </div>
                <div class="search-result">
                    <div class="search-image">
                        <img src="http://dummyimage.com/180x250.png/cc0000/ffffff" />
                    </div>
                    {{!-- <div class="search-content">
                        <h3>Human Communications Planner</h3>
                        <p><i class="ion-android-star"></i><span>7.4</span> /10</p>
                        <p>Deleniti tempora eos doloremque in pariatur debitis blanditiis delectus cumque. Repellendus dolorum fugiat rerum accusantium magnam pariatur consequatur ad mollitia. Beatae commodi nam. Omnis cumque vitae pariatur maiores incidunt laudantium consectetur voluptatibus fuga. Officia consequatur quia necessitatibus maxime aperiam non sit vel.</p>
                    </div> --}}
                </div>
            </div> --}}
        </div>
    </header>

    {{{ body }}}

    <footer class="ht-footer">
        <div class="container">
            <div class="flex-parent-ft">
                <div class="flex-child-ft item1">
                    <a href="index-2.html"><img class="logo" src="images/logo1.png" alt=""></a>
                    <p>5th Avenue st, manhattan<br>
                        New York, NY 10001</p>
                    <p>Call us: <a href="#">(+01) 202 342 6789</a></p>
                </div>
                <div class="flex-child-ft item2">
                    <h4>Menu</h4>
                    <ul>
                        <li><a href="#">About</a></li>
                        <li><a href="#">Blockbuster</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Forums</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Help Center</a></li>
                    </ul>
                </div>
                <div class="flex-child-ft item3">
                    <h4>Điều Khoản</h4>
                    <ul>
                        <li><a href="#">Điều khoản sử dụng</a></li>
                        <li><a href="#">Chính sách bảo mật</a></li>
                        <li><a href="#">An toàn</a></li>
                    </ul>
                </div>
                <div class="flex-child-ft item4">
                    <h4>Tài Khoản</h4>
                    <ul>
                        <li><a href="#">Tài khoản cá nhân</a></li>
                        <li><a href="#">Danh sách theo dõi</a></li>
                        <li><a href="#">Bộ sưu tập</a></li>
                        <li><a href="#">Hướng dẫn sử dụng</a></li>
                    </ul>
                </div>
                <div class="flex-child-ft item5">
                    <h4>Bản Tin</h4>
                    <p>Đăng ký hệ thống bản tin của chúng tôi ngay bây giờ <br> để nhận tin tức mới nhất từ ​​chúng tôi.</p>
                    <form action="#">
                        <input type="text" placeholder="Enter your email...">
                    </form>
                    <a href="#" class="btn">Đăng ký ngay <i class="ion-ios-arrow-forward"></i></a>
                </div>
            </div>
        </div>
        <div class="ft-copyright">
            <div class="ft-left">
                <p><a target="_blank" href="https://www.templateshub.net">Bản mẫu</a></p>
            </div>
            <div class="backtotop">
                <p><a href="#" id="back-to-top">Quay lại trang đầu <i class="ion-ios-arrow-thin-up"></i></a></p>
            </div>
        </div>
    </footer>
</body>

<footer>
    <script src="/js/jquery.js"></script>
    <script src="/js/plugins.js"></script>
    <script src="/js/plugins2.js"></script>
    <script src="/js/custom.js"></script>
    <script src="/js/alpine.min.js"></script>
    <script src="/js/axios.min.js"></script>
    <script src="https://kit.fontawesome.com/4316af07bc.js" crossorigin="anonymous"></script>
    <script type="text/javascript" defer>
        function loginHandler(event, data) {
            event.preventDefault();
            
            axios.post('/authen/login', data)
                .then((response) => response.data)
                .then((data) => {
                    if(data.isSuccess) {
                        location.reload();
                    }
                    else {
                        alert(data.message); 
                    }
                })
                .catch((error) => {
                    console.log(error);
                });
        }

        function forgotPassword(event, email) {
            event.preventDefault();

             axios.post('/forgot-password', { email })
                .then((response) => response.data)
                .then((data) => {
                    if(data.isSuccess) {
                        alert(data.message);
                    }
                    else {
                        alert(data.message); 
                    }
                })
                .catch((error) => {
                    console.log(error);
                });
        }

        function registration(event, postData, confPassword) {
            event.preventDefault();

            if(postData.password !== confPassword) {
                alert('confirm password is wrong');
                return;
            }

            axios.post('/registration', postData)
                .then((response) => response.data)
                .then((data) => {
                    if(data.isSuccess) {
                        alert(data.message);
                    }
                    else {
                        alert(data.message); 
                    }
                })
                .catch((error) => {
                    console.log(error);
                });
        }

        function initSearch() {
            return {
                movies: [],
                loading: false,
                fetchMovies(key) {
                    fetch(`/search?name=${key}`)    
                    .then((raw) => raw.json())
                    .then((data) => {
                       if(data.isSuccess) {
                            this.movies = data.data;
                       }
                    })
                    .catch((error) => console.log(error));
                }
            }
        }
    </script>
    {{{block "scripts"}}}
</footer>

</html>